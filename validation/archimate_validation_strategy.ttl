@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix archimate: <https://purl.org/archimate#> .
@base <https://purl.org/archimate/validation/strategy#> .

### SHACL Validation: Strategy Layer — Composition, Aggregation, Realization
### ArchiMate 3.2 Specification — Appendix B Relationship Matrix
###
### Elements: Resource, Capability, ValueStream, CourseOfAction
###
### Relationship types validated here:
###   c=composition, g=aggregation, r=realization
###
### Excluded (covered by Levels 1 & 2):
###   flow, triggering, serving  → Level 2 §1 Generic Metamodel
###   access                     → no passive structure targets for strategy elements
###   association                → universally permissive
###   specialization             → Level 1 §3 same-type constraint
###   influence                  → Level 2 §7 Motivation Metamodel
###   assignment                 → Level 2 §§1-2 (Resource→Capability/ValueStream)
###
### Derived from relationships.xml
###

<#> rdf:type owl:Ontology ;
    owl:imports <https://purl.org/archimate/owl> ;
    rdfs:label "ArchiMate Relationship Validation - Strategy Layer" ;
    rdfs:comment "Composition, aggregation, and realization constraints for Strategy layer elements per ArchiMate 3.2." ;
    dct:creator "Alberto D. Mendoza" ;
    dct:modified "2026-02-20"^^xsd:date ;
    sh:declare [
        sh:prefix "archimate" ;
        sh:namespace "https://purl.org/archimate#"^^xsd:anyURI
    ] ,
    [
        sh:prefix "rdf" ;
        sh:namespace "http://www.w3.org/1999/02/22-rdf-syntax-ns#"^^xsd:anyURI
    ] ,
    [
        sh:prefix "rdfs" ;
        sh:namespace "http://www.w3.org/2000/01/rdf-schema#"^^xsd:anyURI
    ] .


### Resource

<#ResourceRelationships> rdf:type sh:NodeShape ;
    sh:targetClass archimate:Resource ;
    rdfs:label "Resource Valid Relationships" ;
    rdfs:comment "Validates composition, aggregation, and realization from Resource elements." ;

    # composition (c): Grouping, Resource
    sh:property [
        sh:path archimate:composition ;
        sh:or ( [ sh:class archimate:Grouping ] [ sh:class archimate:Resource ] ) ;
        sh:message "Resource: composition is only valid to Grouping, Resource."
    ] ;

    # aggregation (g): Grouping, Resource
    sh:property [
        sh:path archimate:aggregation ;
        sh:or ( [ sh:class archimate:Grouping ] [ sh:class archimate:Resource ] ) ;
        sh:message "Resource: aggregation is only valid to Grouping, Resource."
    ] ;

    # realization (r): Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement
    sh:property [
        sh:path archimate:realization ;
        sh:or (
            [ sh:class archimate:Constraint ]
            [ sh:class archimate:CourseOfAction ]
            [ sh:class archimate:Goal ]
            [ sh:class archimate:Grouping ]
            [ sh:class archimate:Outcome ]
            [ sh:class archimate:Principle ]
            [ sh:class archimate:Requirement ]
        ) ;
        sh:message "Resource: realization is only valid to Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement."
    ] ;

    .


### Capability

<#CapabilityRelationships> rdf:type sh:NodeShape ;
    sh:targetClass archimate:Capability ;
    rdfs:label "Capability Valid Relationships" ;
    rdfs:comment "Validates composition, aggregation, and realization from Capability elements." ;

    # composition (c): Capability, Grouping
    sh:property [
        sh:path archimate:composition ;
        sh:or ( [ sh:class archimate:Capability ] [ sh:class archimate:Grouping ] ) ;
        sh:message "Capability: composition is only valid to Capability, Grouping."
    ] ;

    # aggregation (g): Capability, Grouping
    sh:property [
        sh:path archimate:aggregation ;
        sh:or ( [ sh:class archimate:Capability ] [ sh:class archimate:Grouping ] ) ;
        sh:message "Capability: aggregation is only valid to Capability, Grouping."
    ] ;

    # realization (r): Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement
    sh:property [
        sh:path archimate:realization ;
        sh:or (
            [ sh:class archimate:Constraint ]
            [ sh:class archimate:CourseOfAction ]
            [ sh:class archimate:Goal ]
            [ sh:class archimate:Grouping ]
            [ sh:class archimate:Outcome ]
            [ sh:class archimate:Principle ]
            [ sh:class archimate:Requirement ]
        ) ;
        sh:message "Capability: realization is only valid to Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement."
    ] ;

    .


### ValueStream

<#ValueStreamRelationships> rdf:type sh:NodeShape ;
    sh:targetClass archimate:ValueStream ;
    rdfs:label "ValueStream Valid Relationships" ;
    rdfs:comment "Validates composition, aggregation, and realization from ValueStream elements." ;

    # composition (c): Grouping, ValueStream
    sh:property [
        sh:path archimate:composition ;
        sh:or ( [ sh:class archimate:Grouping ] [ sh:class archimate:ValueStream ] ) ;
        sh:message "ValueStream: composition is only valid to Grouping, ValueStream."
    ] ;

    # aggregation (g): Grouping, ValueStream
    sh:property [
        sh:path archimate:aggregation ;
        sh:or ( [ sh:class archimate:Grouping ] [ sh:class archimate:ValueStream ] ) ;
        sh:message "ValueStream: aggregation is only valid to Grouping, ValueStream."
    ] ;

    # realization (r): Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement
    sh:property [
        sh:path archimate:realization ;
        sh:or (
            [ sh:class archimate:Constraint ]
            [ sh:class archimate:CourseOfAction ]
            [ sh:class archimate:Goal ]
            [ sh:class archimate:Grouping ]
            [ sh:class archimate:Outcome ]
            [ sh:class archimate:Principle ]
            [ sh:class archimate:Requirement ]
        ) ;
        sh:message "ValueStream: realization is only valid to Constraint, CourseOfAction, Goal, Grouping, Outcome, Principle, Requirement."
    ] ;

    .


### CourseOfAction

<#CourseOfActionRelationships> rdf:type sh:NodeShape ;
    sh:targetClass archimate:CourseOfAction ;
    rdfs:label "CourseOfAction Valid Relationships" ;
    rdfs:comment "Validates composition, aggregation, and realization from CourseOfAction elements." ;

    # composition (c): CourseOfAction, Grouping
    sh:property [
        sh:path archimate:composition ;
        sh:or ( [ sh:class archimate:CourseOfAction ] [ sh:class archimate:Grouping ] ) ;
        sh:message "CourseOfAction: composition is only valid to CourseOfAction, Grouping."
    ] ;

    # aggregation (g): CourseOfAction, Grouping
    sh:property [
        sh:path archimate:aggregation ;
        sh:or ( [ sh:class archimate:CourseOfAction ] [ sh:class archimate:Grouping ] ) ;
        sh:message "CourseOfAction: aggregation is only valid to CourseOfAction, Grouping."
    ] ;

    # realization (r): Constraint, Goal, Grouping, Outcome, Principle, Requirement
    sh:property [
        sh:path archimate:realization ;
        sh:or (
            [ sh:class archimate:Constraint ]
            [ sh:class archimate:Goal ]
            [ sh:class archimate:Grouping ]
            [ sh:class archimate:Outcome ]
            [ sh:class archimate:Principle ]
            [ sh:class archimate:Requirement ]
        ) ;
        sh:message "CourseOfAction: realization is only valid to Constraint, Goal, Grouping, Outcome, Principle, Requirement."
    ] ;

    .
